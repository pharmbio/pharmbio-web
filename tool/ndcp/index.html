<html>

    <head>
  <meta charset="utf-8">
  <title>NDCP | pharmb.io - Pharmaceutical Bioinformatics Research Group at Uppsala University</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="/css/webflow.css" rel="stylesheet" type="text/css">
  <link href="/css/pharmbio.webflow.css?1643640977" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
  <script type="text/javascript">
    WebFont.load({
      google: {
        families: ["Ubuntu:300,300italic,400,400italic,500,500italic,700,700italic","Raleway:regular,500,600,700,800,900"]
      }
    });
  </script>
  <script src="/js/modernizr.js" type="text/javascript"></script>
  <link href="/img/pharmbio_logo_square_64x64.png" rel="shortcut icon" type="image/x-icon">
  <link href="/img/pharmbio_logo_square_64x64.png" rel="apple-touch-icon">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-86146183-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>


    
  <div class="section-header" id="section-header">
    <div class="section-header-container w-container">
      <div class="navbar w-nav" data-animation="default" data-collapse="medium" data-contain="1" data-doc-height="1" data-duration="400" data-no-scroll="1">
        <div class="navbar-container w-container">
          <a class="navbar-brand w-nav-brand" href="/">
              <img class="navbar-logo" src="/img/pharmbio-logo-new.png">
          </a>
          <div class="navbar-menubutton w-nav-button">
            <div class="w-icon-nav-menu"></div>
          </div>
          <a class="navbar-uulogo-link" href="http://farmbio.uu.se/forskning/researchgroups/pb/Data-intensive/" target="_blank"><img class="navbar-uulogo-img" src="/img/uulogo_64x64.png"></a>
          <nav class="navbar-menu w-nav-menu" role="navigation" style="float: right">
              
              <a class="navbar-link w-nav-link" href="/project/">Projects</a>
              
              <a class="navbar-link w-nav-link" href="/people/">People</a>
              
              <a class="navbar-link w-nav-link" href="/infrastructure/">Infrastructure</a>
              
              <a class="navbar-link w-nav-link" href="/publication/">Publications</a>
              
              
              
              <a class="navbar-link w-nav-link" href="/tool/">Tools</a>
              
              <a class="navbar-link w-nav-link" href="/education/">Education</a>
              
              <a class="navbar-link w-nav-link" href="/about/">About</a>
              
              
              
              
              
              
              
          </nav>
        </div>
      </div>
    </div>
  </div>

              <div>
          <div class="section-content-container w-container content">

        <h1 style="font-size: 1.4em">NDCP</h1>
        <p><a href="/tool">&larr; Back to tools</a></p>
        <div class="tool-links">
            <h3 style="font-size: 1.1em; margin: 0.2em 0;">External Links</h2>
            <ul>
                <li><a href="" target="_blank">Website</a></li>
                <li><a href="https://github.com/pharmbio/nondisc-acp" target="_blank">Github</a></li>
                <li><a href="" target="_blank">Documentation</a></li>
                <li><a href="https://arxiv.org/abs/1806.04000" target="_blank">Publication</a></li>
            </ul>
        </div>
        

<h1 id="ndcp-non-disclosed-conformal-prediction">NDCP: Non-Disclosed Conformal Prediction</h1>

<p>This is an implementation for ligand-based modeling of the method described in:</p>

<p><strong>Aggregating Predictions on Multiple Non-disclosed Datasets using Conformal Prediction</strong><br>
Ola Spjuth, Lars Carlsson, Niharika Gauraha<br>
<a href="https://arxiv.org/abs/1806.04000">arXiv:1806.04000 [stat.ML]</a><br></p>

<h2 id="background">Background</h2>

<p>It is a common objective for different organizations to be able to contribute to improved predictive models, such as in pre-competitive alliances, but there is often problems with sharing internal data between the parties. One example is in the pharmaceutical industry, where predictions on existing data (such as measured assays of various hazard endpoints for chemical compounds) constitute valuable assets and it would be desirable for all companies to have as good predictive models as possible; but sharing data between companies is usually not so easy.</p>


<figure>
    
        <img src="/img/tool/ndcp/fig-overview.png" alt="Figure 1: a) The most common approach is to collect data from different data sources (D1 −D3) into a single dataset, which then is used to train a model M that can be used to make a prediction P on a query object Q. b) The aggregated TCP approach implies that a model Mn is trained at each data source Dn, and the query object Q is passed on to each model, and predictions Pn are then aggregated to deliver the resulting prediction P. The gray wireframes are used to visualize the different actors taking part in the procedure independent of each other. " />
    
    
    <figcaption>
        <p>
        Figure 1: a) The most common approach is to collect data from different data sources (D1 −D3) into a single dataset, which then is used to train a model M that can be used to make a prediction P on a query object Q. b) The aggregated TCP approach implies that a model Mn is trained at each data source Dn, and the query object Q is passed on to each model, and predictions Pn are then aggregated to deliver the resulting prediction P. The gray wireframes are used to visualize the different actors taking part in the procedure independent of each other. 
        
            
        
        </p> 
    </figcaption>
    
</figure>


<h2 id="method">Method</h2>

<p>The idea of the method is that the different parties train an individual model of their local data, and make this available as a web service accepting a SMILES as input, and delivers results in form of p-values (one per each class in the classification case), and a prediction interval (in the regression case). No other information is transferred over the network, making the implementation preserve privacy completely. The results from the contributing parties is then merged as described in Spjuth et al 2018 <a href="https://arxiv.org/abs/1806.04000">(https://arxiv.org/abs/1806.04000)</a> to yield predictions with lower variance and improved efficiency.</p>

<h2 id="usage">Usage</h2>

<p>NDCP is available as two docker container images. One docker image (&lsquo;Deploy model&rsquo;) is deployed on all sites that will serve predictions (without disclosing data); there is no limit to how many different instances that can be deployed. The second docker image (&lsquo;Prediction server&rdquo;) contains a server that aggregates p-values and makes available a web page that can be used to consume the service.</p>

<p>Docker images can be downloaded from:</p>

<table>
<thead>
<tr>
<th>Docker image</th>
<th>URL</th>
</tr>
</thead>

<tbody>
<tr>
<td>Deploy model</td>
<td><a href="http://pele.farmbio.uu.se/ndcp/deploy-model.tar.gz">http://pele.farmbio.uu.se/ndcp/deploy-model.tar.gz</a></td>
</tr>

<tr>
<td>Prediction server</td>
<td><a href="http://pele.farmbio.uu.se/ndcp/ndcp-predict.tar.gz">http://pele.farmbio.uu.se/ndcp/ndcp-predict.tar.gz</a></td>
</tr>
</tbody>
</table>

<p>The &ldquo;model Docker&rdquo; builds a model from a file with molecules (accepts .sdf or tab separated .tsv with SMILES and property).</p>

<h3 id="build-and-deploy-model">Build and deploy model</h3>

<pre><code>docker load &lt; deploy-model.tar.gz
</code></pre>

<p>Create a data folder <code>mkdir &lt;data dir&gt;</code> and copy SD-file and cpsign-license into the folder.
Some CPSign specific settings are needed:</p>

<table>
<thead>
<tr>
<th>Param</th>
<th>Example value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>--calibration-ratio</code></td>
<td><code>0.20</code></td>
<td>Part of training set to use for calibration</td>
</tr>

<tr>
<td><code>--response-name</code></td>
<td><code>activity</code></td>
<td>Name of property to model</td>
</tr>

<tr>
<td><code>--labels</code></td>
<td><code>&quot;A,N&quot;</code></td>
<td>Values of property to model</td>
</tr>

<tr>
<td><code>--cptype</code></td>
<td><code>1</code></td>
<td>Specify that we are doing classification</td>
</tr>

<tr>
<td><code>--nr-models</code></td>
<td><code>1</code></td>
<td>Number of models to build</td>
</tr>

<tr>
<td><code>--model-name</code></td>
<td><code>&quot;TestMod&quot;</code></td>
<td>Name of the model that is built</td>
</tr>
</tbody>
</table>

<p>These parameters are added at the end when building, see below:</p>

<pre><code>docker run -d -p 8080:8080 -v &lt;absolute data dir&gt;:/build/source &lt;image name:tag&gt; \
 --calibration-ratio 0.20 --nr-models 1 --labels &quot;A,N&quot; --logfile /build/full.log \
 --cptype 1 --response-name activity --model-name &quot;TestMod&quot;
</code></pre>

<h3 id="deploy-webpage-to-view-aggregation">Deploy webpage to view aggregation</h3>

<pre><code>docker load &lt; ndcp-predict.tar.gz
docker run -p 8080:8083
</code></pre>

<h2 id="running-example">Running example</h2>

<p>A running example is deployed at <a href="http://ndcp.service.pharmb.io">http://ndcp.service.pharmb.io</a></p>


<figure>
    
        <img src="/img/tool/ndcp/ndcp.png" alt="Figure 2: Example of a running deployment of NDCP." />
    
    
    <figcaption>
        <p>
        Figure 2: Example of a running deployment of NDCP.
        
            
        
        </p> 
    </figcaption>
    
</figure>


<h2 id="ligand-based-implementation">Ligand-based implementation</h2>

<p>The implementation uses CPSign (<a href="http://cpsign-docs.genettasoft.com/">http://cpsign-docs.genettasoft.com/</a>) as the underlying modeling method with SVM and Signatures. A license is required but these are generously provided by <a href="http://www.genettasoft.com">GenettaSoft</a>.</p>

<p><img src="/img/tool/ndcp/UU_logo.png" height="160">
<img src="/img/tool/ndcp/az-logo.png" height="100">
<img src="/img/tool/ndcp/genetta-logo.jpg" height="75">
<img src="/img/tool/ndcp/royal_holloway_logo.jpg" height="85"></p>

            </div>
</div>

      <div class="section-footer">
    <div class="section-footer-container w-container">
        
        <div class="footer-text">
            <p>
            <strong>Pharmaceutical Bioinformatics Research Group</strong><br>
            Department of Pharmaceutical Biosciences<br>
            Uppsala University, Sweden<br>
            GitHub: <a href="https://github.com/pharmbio">github.com/pharmbio</a>
            </p>
        </div>
    </div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js" type="text/javascript"></script>
  <script src="/js/webflow.js" type="text/javascript"></script>
  
</body>
</html>

